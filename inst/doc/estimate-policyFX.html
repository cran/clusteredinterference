<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Brian G. Barkley" />

<meta name="date" content="2018-02-12" />

<title>Estimating causal policyFX with clusteredinterference</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Estimating causal <code>policyFX</code> with <code>clusteredinterference</code></h1>
<h4 class="author"><em>Brian G. Barkley</em></h4>
<h4 class="date"><em>2018-02-12</em></h4>



<p>First, load the <code>clusteredinterference</code> package</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(clusteredinterference)</a></code></pre></div>
<p>Now load a quick data example that’s included in the package</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(<span class="st">&quot;toy_data&quot;</span>) </a></code></pre></div>
<section id="estimation" class="level2">
<h2>Estimation</h2>
<p>Estimation is implemented with the <code>policyFX()</code> function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">1113</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">causal_fx &lt;-<span class="st"> </span><span class="kw">policyFX</span>(</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="dt">data =</span> toy_data,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  <span class="dt">formula =</span> Outcome <span class="op">|</span><span class="st"> </span>Treatment <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Distance <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Cluster_ID) <span class="op">|</span><span class="st"> </span>Cluster_ID,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  <span class="dt">alphas =</span> <span class="kw">c</span>(.<span class="dv">3</span>, <span class="fl">.5</span>), </a>
<a class="sourceLine" id="cb3-6" data-line-number="6">  <span class="dt">k_samps =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">)</a></code></pre></div>
<p>The <code>policyFX()</code> function outputs a <code>&quot;policyFX&quot;</code> object, which works well with a few methods, including:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">summary</span>(causal_fx)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; ------------- causal estimates --------------</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;     estimand estimate     se     LCI    UCI</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;      mu(0.3)   0.6523 0.0635  0.5279 0.7767</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt;      mu(0.5)   0.6075 0.0505  0.5086 0.7063</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt;     mu0(0.3)   0.6707 0.0736  0.5264 0.8151</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;     mu0(0.5)   0.5849 0.0728  0.4422 0.7276</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;     mu1(0.3)   0.2799 0.0563  0.1695 0.3902</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;     mu1(0.5)   0.3974 0.0577  0.2842 0.5105</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  OE(0.5,0.3)  -0.0449 0.0366 -0.1165 0.0268</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  OE(0.3,0.5)   0.0449 0.0366 -0.0268 0.1165</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;           ... and 4 more rows ... </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; -------------- treatment model -------------</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt; Generalized linear mixed model fit by maximum likelihood (Adaptive</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;   Gauss-Hermite Quadrature, nAGQ = 2) [glmerMod]</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;  Family: binomial  ( logit )</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; Formula: Treatment ~ Age + Distance + (1 | Cluster_ID)</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;    Data: data</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;      AIC      BIC   logLik deviance df.resid </span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt; 137.0345 147.3743 -64.5172 129.0345       94 </span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; Random effects:</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;  Groups     Name        Std.Dev.</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;  Cluster_ID (Intercept) 1.18    </span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; Number of obs: 98, groups:  Cluster_ID, 30</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; Fixed Effects:</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">#&gt; (Intercept)          Age     Distance  </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt;    -1.44609     -0.00851      0.26097  </span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">#&gt; ------------- propensity scores -------------</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt;      1      2      3      4      5      6      7      8      9     10 </span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt;  0.105  0.162  0.086  0.102  0.167  0.045  0.244 0.0934 0.0765  0.197 </span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">#&gt;     11     12     13     14     15     16     17     18     19     20 </span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; 0.0653  0.281  0.104  0.365 0.0867  0.198  0.207  0.106 0.0847  0.134 </span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt;     21     22     23     24     25     26     27     28     29     30 </span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">#&gt;  0.103  0.111  0.105  0.302 0.0434 0.0943 0.0443 0.0512   0.13  0.263 </span></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; ---------------------------------------------</span></a></code></pre></div>
<section id="necessary-arguments" class="level3">
<h3>Necessary arguments</h3>
<section id="data" class="level4">
<h4><code>data</code></h4>
<p>A <code>data.frame</code>. At present, <code>tibble</code>s are coerced back to standard <code>data.frame</code>s. I also recommend against using <code>factor</code>s in the columns.</p>
</section>
<section id="alphas" class="level4">
<h4><code>alphas</code></h4>
<p>A numeric vector of probabilities corresponding the the policies of interest. Each must be between 0 and 1.</p>
</section>
<section id="k_samps" class="level4">
<h4><code>k_samps</code></h4>
<p>The user must specify the number of sum-sampled vectors for estimating the counterfactual probabilities (nuisance parameters). It is recommended to choose <code>k_samps &lt;=5</code>. To avoid the sub-sampling approximation and use all possible vectors, set <code>k_samps=0</code>.</p>
</section>
<section id="formula" class="level4">
<h4><code>formula</code></h4>
<p>The formula may be the trickiest, and it has plenty of information. It provides:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">outcome <span class="op">|</span><span class="st"> </span>treatment <span class="op">~</span><span class="st"> </span>predictors and random intercept <span class="op">|</span><span class="st"> </span>clustering specification</a></code></pre></div>
<p>Note that the middle section is passed to <code>glmer()</code> to fit the mixed effects model, so this is how to specify the modeling formula.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">Treatment <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Distance <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Cluster_ID)</a></code></pre></div>
<p>See below for the model output.</p>
</section>
</section>
<section id="formal-arguments-with-defaults" class="level3">
<h3>Formal arguments with defaults</h3>
<section id="verbose-false" class="level4">
<h4><code>verbose = FALSE</code></h4>
</section>
<section id="root_options-null" class="level4">
<h4><code>root_options = NULL</code></h4>
<p>This is for <code>rootSolve::multiroot()</code> used in the point estimation procedure. E.g., this will be passed in:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">root_options =<span class="st"> </span><span class="kw">list</span>(<span class="dt">atol =</span> <span class="fl">1e-7</span>) </a></code></pre></div>
</section>
<section id="nagq2" class="level4">
<h4><code>nAGQ=2</code></h4>
<p>This is for <code>lme4::glmer()</code>. The default in <code>glmer()</code> is <code>nAGQ=1</code>, which indicates a Laplace approximation to the log-likelihood. Instead, in this package the default is <code>nAGQ=2</code>, which indicates that <code>n=2</code> Adaptive Gaussian Quadrature points will be used. This is slightly slower but is a more accurate calculation. In limited testing, it seems that <code>nAGQ=2</code> was almost as accurate as higher values, so 2 was chosen as the default. See their documentation for more details.</p>
</section>
<section id="return_matrices-false" class="level4">
<h4><code>return_matrices = FALSE</code></h4>
<p>If <code>TRUE</code>, this will return the “bread” and “meat” matrices in the variance calculations. The default is <code>FALSE</code> as these matrices can be quite large.</p>
</section>
</section>
<section id="dots-tricks" class="level3">
<h3>Dots tricks</h3>
<p>In the event you’re only interested in a subset of contrasts, you can pass a customized grid into the function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">my_grid &lt;-<span class="st"> </span><span class="kw">makeTargetGrid</span>(<span class="dt">alphas =</span> (<span class="dv">3</span><span class="op">:</span><span class="dv">8</span>)<span class="op">/</span><span class="dv">20</span>, <span class="dt">small_grid =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">head</span>(my_grid)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt;   alpha1_num alpha2_num trt alpha1 alpha2 estimand effect_type estVar</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 1          1         NA  NA   0.15     NA       mu     outcome   TRUE</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 2          2         NA  NA   0.20     NA       mu     outcome   TRUE</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 3          3         NA  NA   0.25     NA       mu     outcome   TRUE</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 4          4         NA  NA   0.30     NA       mu     outcome   TRUE</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 5          5         NA  NA   0.35     NA       mu     outcome   TRUE</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; 6          6         NA  NA   0.40     NA       mu     outcome   TRUE</span></a></code></pre></div>
<p>This can be particularly useful for plotting, as you can “turn off” the variance estimates</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">my_grid<span class="op">$</span>estVar &lt;-<span class="st"> </span><span class="ot">FALSE</span></a></code></pre></div>
<p>This is available through the dots argument. Note that when supplying a custom <code>target_grid</code>, it’s not necessary to specify the <code>alphas</code> argument, as that is taken directly from <code>target_grid</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">causal_fx2 &lt;-<span class="st"> </span><span class="kw">policyFX</span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="dt">data =</span> toy_data,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="dt">formula =</span> Outcome <span class="op">|</span><span class="st"> </span>Treatment <span class="op">~</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Distance <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Cluster_ID) <span class="op">|</span><span class="st"> </span>Cluster_ID,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="co"># alphas = c(.3, .5), </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">target_grid =</span> my_grid,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  <span class="dt">k_samps =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">  <span class="dt">root_options =</span> <span class="kw">list</span>(<span class="dt">atol=</span><span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="kw">print</span>(causal_fx, <span class="dt">nrows =</span> <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; ------------- causal estimates --------------</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;      estimand estimate     se     LCI      UCI</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;       mu(0.3)   0.6523 0.0635  0.5279  0.77667</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt;       mu(0.5)   0.6075 0.0505  0.5086  0.70633</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt;      mu0(0.3)   0.6707 0.0736  0.5264  0.81506</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt;      mu0(0.5)   0.5849 0.0728  0.4422  0.72760</span></a>
<a class="sourceLine" id="cb10-18" data-line-number="18"><span class="co">#&gt;      mu1(0.3)   0.2799 0.0563  0.1695  0.39020</span></a>
<a class="sourceLine" id="cb10-19" data-line-number="19"><span class="co">#&gt;      mu1(0.5)   0.3974 0.0577  0.2842  0.51055</span></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt;   OE(0.5,0.3)  -0.0449 0.0366 -0.1165  0.02681</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt;   OE(0.3,0.5)   0.0449 0.0366 -0.0268  0.11651</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt;  SE0(0.5,0.3)  -0.0858 0.0403 -0.1648 -0.00677</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;           ... and 3 more rows ... </span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; ---------------------------------------------</span></a></code></pre></div>
</section>
<section id="plotting" class="level3">
<h3>Plotting</h3>
<p>The tidy dataframe <code>estimates</code> can be easily used for plotting:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">plotdat &lt;-<span class="st"> </span>causal_fx2<span class="op">$</span>estimates[causal_fx2<span class="op">$</span>estimates<span class="op">$</span>estimand_type<span class="op">==</span><span class="st">&quot;mu&quot;</span>,]</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">plot</span>(<span class="dt">x =</span> plotdat<span class="op">$</span>alpha1, <span class="dt">y =</span> plotdat<span class="op">$</span>estimate, <span class="dt">main =</span> <span class="st">&quot;Estimated Population Means&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</section>
<section id="treatment-model" class="level3">
<h3>Treatment model</h3>
<p>As mentioned above, the treatment model is specified via the <code>formula</code> argument. For example, compare:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Returns the specified formula, coerced to a Formula object</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">causal_fx<span class="op">$</span>formula</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; Outcome | Treatment ~ Age + Distance + (1 | Cluster_ID) | Cluster_ID</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># causal_fx$model is a glmerMod S4 object</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">causal_fx<span class="op">$</span>model<span class="op">@</span>call</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; lme4::glmer(formula = Treatment ~ Age + Distance + (1 | Cluster_ID), </span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt;     data = data, family = stats::binomial, nAGQ = nAGQ)</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">lme4<span class="op">::</span><span class="kw">getME</span>(causal_fx<span class="op">$</span>model, <span class="kw">c</span>(<span class="st">&quot;beta&quot;</span>, <span class="st">&quot;theta&quot;</span>))</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; $beta</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; [1] -1.44608710 -0.00850977  0.26096895</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; $theta</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; Cluster_ID.(Intercept) </span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt;               1.180325</span></a></code></pre></div>
</section>
</section>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
